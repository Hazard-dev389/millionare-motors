<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact - Millionaire Motors</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* General Styles */
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      color: #333;
      scroll-behavior: smooth;
    }
    header {
      background: linear-gradient(90deg, #1a1a1a, #4B0082);
      color: #fff;
      padding: 1.5rem 2rem;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
    }
    main {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 2rem;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      position: relative;
    }
    h2 {
      color: #4B0082;
      margin-bottom: 1rem;
    }
    p { line-height: 1.6; }

    /* Contact Info */
    .contact-info div { margin-bottom: 1rem; }
    a.contact-button {
      display: inline-block;
      padding: 0.8rem 1.5rem;
      background-color: #25D366;
      color: #fff;
      font-weight: bold;
      text-decoration: none;
      border-radius: 50px;
      transition: background 0.3s ease;
    }
    a.contact-button:hover { background-color: #128C7E; }

    /* Contact Form */
    .contact-form { margin-top: 2rem; }
    form { display: flex; flex-direction: column; }
    form input, form textarea, form button {
      margin-bottom: 1rem;
      padding: 0.8rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    form input:focus, form textarea:focus { border-color: #4B0082; outline: none; }
    form button {
      background-color: #4B0082;
      color: #fff;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    form button:hover { background-color: #1a1a1a; }

    .message-box {
      padding: 1rem;
      margin-top: 1rem;
      display: none;
      border-radius: 8px;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .message-success { background-color: #d4edda; color: #155724; }
    .message-error { background-color: #f8d7da; color: #721c24; }

    /* Google Maps */
    .location iframe {
      width: 100%;
      height: 300px;
      border: 0;
      border-radius: 12px;
    }
    .location a { color: #4B0082; text-decoration: none; font-weight: bold; }
    .location a:hover { text-decoration: underline; }

    /* Image Uploads */
    .uploads {
      display: grid;
      grid-template-columns: repeat(auto-fill,minmax(200px,1fr));
      gap: 15px;
      margin-top: 2rem;
    }
    .uploads img {
      width: 100%;
      border-radius: 12px;
      object-fit: cover;
      border: 2px solid #4B0082;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }
    .uploads img:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    /* Back-to-top button */
    #backToTop {
      position: fixed;
      bottom: 40px;
      right: 40px;
      background-color: #4B0082;
      color: #fff;
      padding: 0.8rem 1rem;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      display: none;
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      transition: background 0.3s ease;
    }
    #backToTop:hover { background-color: #1a1a1a; }

    @media (max-width: 600px){
      header h1 { font-size: 1.5rem; }
      #backToTop { bottom: 20px; right: 20px; }
    }
  </style>
</head>
<body>

  <header>
    <h1>Contact Millionaire Motors</h1>
  </header>

  <main>
    <p>Reach out via phone, WhatsApp, or our contact form below. You can also visit our location or view our latest uploads.</p>

    <!-- Contact Info -->
    <div class="contact-info">
      <h2>Contact Info</h2>
      <div><strong>Phone:</strong> <a href="tel:+254115908207">Call us</a></div>
      <div><strong>WhatsApp:</strong>
        <a class="contact-button" href="https://wa.me/254115908207" target="_blank" rel="noopener noreferrer">
          Chat on WhatsApp
        </a>
      </div>
    </div>

    <!-- Contact Form -->
    <div class="contact-form">
      <h2>Send Us a Message</h2>
      <form id="contactForm">
        <input type="text" name="name" placeholder="Your Name" required>
        <input type="email" name="email" placeholder="Your Email" required>
        <textarea name="message" rows="5" placeholder="Your Message" required></textarea>
        <button type="submit">Send Message</button>
      </form>
      <div id="formMessage" class="message-box"></div>
    </div>

    <!-- Location -->
    <div class="location">
      <h2>Our Location</h2>
      <iframe 
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1994.070404038737!2d36.80637767615062!3d-1.3036446991442434!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x182f10d8747b5d3d%3A0x5e7f7b1db9f3d9e0!2sMillionaire%20Motors!5e0!3m2!1sen!2ske!4v1700119512330!5m2!1sen!2ske" 
        allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
      </iframe>
      <p><a href="https://goo.gl/maps/j7jC2GoQFa6GZJgM8" target="_blank">Open in Google Maps</a></p>
    </div>

    <!-- Image/Uploads -->
    <div class="uploads" id="uploadsSection">
      <h2>Latest Uploads</h2>
      <!-- Images dynamically loaded here -->
    </div>

  </main>

  <!-- Back-to-top Button -->
  <button id="backToTop">â†‘ Top</button>

  <script>
    // Back-to-top button
    const backToTop = document.getElementById('backToTop');
    window.addEventListener('scroll', () => {
      if(window.scrollY > 300) backToTop.style.display = 'block';
      else backToTop.style.display = 'none';
    });
    backToTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

    // Handle contact form submission
    const form = document.getElementById('contactForm');
    const formMessage = document.getElementById('formMessage');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      formMessage.style.display = 'block';
      formMessage.style.opacity = 0;
      try {
        const response = await fetch('/send', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();
        if(result.success){
          formMessage.className = 'message-box message-success';
          formMessage.textContent = 'Message sent successfully!';
          form.reset();
        } else {
          formMessage.className = 'message-box message-error';
          formMessage.textContent = 'Failed to send message. Try again later.';
        }
      } catch(err){
        formMessage.className = 'message-box message-error';
        formMessage.textContent = 'Error sending message.';
      }
      // Animate fade-in
      let opacity = 0;
      const fadeInterval = setInterval(() => {
        if(opacity >= 1) clearInterval(fadeInterval);
        opacity += 0.05;
        formMessage.style.opacity = opacity;
      }, 20);
    });

    // Load uploaded images dynamically
    async function loadImages() {
      try {
        const res = await fetch('/images');
        const images = await res.json();
        const uploadsSection = document.getElementById('uploadsSection');
        images.forEach(img => {
          const imageElement = document.createElement('img');
          imageElement.src = `/uploads/${img}`;
          imageElement.alt = img;
          uploadsSection.appendChild(imageElement);
        });
      } catch(err){
        console.log('Error loading images:', err);
      }
    }
    loadImages();
  </script>

</body>
</html>